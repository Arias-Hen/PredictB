<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PredictBuild Dashboard</title>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    </noscript>

    {% extends 'sidebar.html' %}
    {% block content %}
    <div class="welcome-banner">
        <h1 class="welcome-title">BIENVENIDO A PROJECTBUILD</h1>
    </div>
</head>

<body>
    <div class="container-fluid mt-5">
        <div class="row">
            <div class="col-10 content">
                <div class="row mt-5">
                    <div class="col-md-6">
                        <h4 class="text-center">VALORACIÓN</h4>
                        <form id="valuation-form">
                            <div class="row">
                                <div class="col-md-5  offset-md-2">
                                    <div class="row m-3b g-10">
                                        <div class="row">
                                            <div class="col-6">
                                                <label for="ciudad" class="form-label">Ciudad:</label>
                                                <select id="ciudad" class="form-select">
                                                    <option value="Madrid">Madrid</option>
                                                </select>
                                            </div>

                                            <div class="col-6">
                                                <label for="distrito" class="form-label">Distrito:</label>
                                                <select id="distrito" class="form-select">
                                                    <option value="Centro">Centro</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <label for="tipo-vivienda" class="form-label">Tipo de vivienda:</label>
                                            <select id="tipo-vivienda" class="form-select">
                                                <option value="Estudio">Estudio</option>
                                                <option value="Apartamento">Apartamento</option>
                                            </select>
                                        </div>
                                        <div class="col">
                                            <label for="num-banos" class="form-label">Número de baños:</label>
                                            <select id="num-banos" class="form-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="orientacion" class="form-label">Orientación:</label>
                                            <select id="orientacion" class="form-select">
                                                <option value="Exterior">Exterior</option>
                                                <option value="Interior">Interior</option>
                                            </select>
                                        </div>
                                        <div class="col">
                                            <label for="planta" class="form-label">Planta:</label>
                                            <select id="planta" class="form-select">
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="metros-cuadrados" class="form-label">Metros Cuadrados:</label>
                                            <select id="metros-cuadrados" class="form-select">
                                                <option value="90">90</option>
                                                <option value="100">100</option>
                                            </select>
                                        </div>
                                        <div class="col">
                                            <label for="tiene-terraza" class="form-label">Tiene terraza:</label>
                                            <select id="tiene-terraza" class="form-select">
                                                <option value="No">No</option>
                                                <option value="Sí">Sí</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mb-3">
                                        <div class="col">
                                            <label for="num-habitaciones" class="form-label">Número de
                                                habitaciones:</label>
                                            <select id="num-habitaciones" class="form-select">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                            </select>
                                        </div>

                                        <div class="col">
                                            <label for="tiene-balcon" class="form-label">Tiene balcón:</label>
                                            <select id="tiene-balcon" class="form-select">
                                                <option value="No">No</option>
                                                <option value="Sí">Sí</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 text-center">
                                    <div class="row mb-3">
                                        <label for="barrio" class="form-label">Barrio:</label>
                                        <select id="barrio" class="form-select">
                                            <option value="Centro">Centro</option>
                                        </select>
                                        <label for="tiene-ascensor" class="form-label">Tiene ascensor:</label>
                                        <select id="tiene-ascensor" class="form-select">
                                            <option value="Sí">Sí</option>
                                            <option value="No">No</option>
                                        </select>
                                        <label for="estado-inmueble" class="form-label">Estado del inmueble:</label>
                                        <select id="estado-inmueble" class="form-select">
                                            <option value="Obra nueva">Obra nueva</option>
                                            <option value="Usado">Usado</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="text-center vl">
                                        <button type="button" class="btn btn-primary" id="valorar">VALORAR</button>
                                    </div>
                                    <div class="mt-15">
                                        <table class="table tb">
                                            <thead>
                                                <tr>
                                                    <th>Precio mínimo</th>
                                                    <th>Precio esperado</th>
                                                    <th>Precio máximo</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td id="precio-minimo">552,723.54</td>
                                                    <td id="precio-esperado">621,813.99</td>
                                                    <td id="precio-maximo">690,904.43</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="text-center">
                                        <button type="button" class="btn btn-primary" id="correccion-manual">CORRECCIÓN
                                            MANUAL</button>
                                    </div>
                                    <div class="mt-3">
                                        <table class="table tb1">
                                            <thead>
                                                <tr>
                                                    <th>Precio esperado</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td id="precio-minimo">552,723.54</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="text-center vl">
                                        <button type="button" class="btn btn-primary" id="tranformar">TRANSFORMAR
                                            A PROYECTO DE VENTA</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="text-center">
                                        <button type="button" class="btn btn-primary" id="vvalorar">VOLVER A
                                            VALORAR</button>
                                    </div>
                                </div>
                            </div>
                        </form>

                    </div>

                    <div class="col-md-6">
                        <h4 class="text-center">VISUALIZACIÓN</h4>
                        <div class="row">
                            <div class="col-6">
                                <canvas id="pie-chart"></canvas>
                            </div>
                            <div class="col-6">
                                <canvas id="bar-chart"></canvas>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-6">
                                <canvas id="line-chart"></canvas>
                            </div>
                            <div class="col-6">
                                <canvas id="stacked-bar-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const pieCtx = document.getElementById('pie-chart').getContext('2d');
        const barCtx = document.getElementById('bar-chart').getContext('2d');
        const lineCtx = document.getElementById('line-chart').getContext('2d');
        const stackedBarCtx = document.getElementById('stacked-bar-chart').getContext('2d');

        new Chart(pieCtx, {
            type: 'pie',
            data: {
                labels: ['Elementos 1', 'Elementos 2', 'Elementos 3', 'Elementos 4', 'Elementos 5'],
                datasets: [{
                    data: [20, 20, 20, 20, 20],
                    backgroundColor: ['#ff6384', '#36a2eb', '#cc65fe', '#ffce56', '#5dc2bd']
                }]
            }
        });

        new Chart(barCtx, {
            type: 'bar',
            data: {
                labels: ['1', '2', '3', '4', '5', '6', '7'],
                datasets: [{
                    data: [8, 12, 9, 10, 6, 8, 14],
                    backgroundColor: '#36a2eb'
                }]
            }
        });

        new Chart(lineCtx, {
            type: 'line',
            data: {
                labels: ['1', '2', '3', '4', '5'],
                datasets: [{
                    data: [10, 15, 20, 25, 30],
                    borderColor: '#cc65fe',
                    fill: false
                }]
            }
        });

        new Chart(stackedBarCtx, {
            type: 'bar',
            data: {
                labels: ['Elementos 1', 'Elementos 2', 'Elementos 3', 'Elementos 4'],
                datasets: [{
                    label: 'Serie 1',
                    data: [10, 20, 30, 40],
                    backgroundColor: '#36a2eb'
                }, {
                    label: 'Serie 2',
                    data: [15, 25, 35, 45],
                    backgroundColor: '#ff6384'
                }]
            },
            options: {
                scales: {
                    x: {
                        stacked: true
                    },
                    y: {
                        stacked: true
                    }
                }
            }
        });
        document.getElementById('valorar').addEventListener('click', function () {
            // Recopilar los valores del formulario
            const data = {
                "ciudad": "Madrid",
                "distrito": "Centro",
                "barrio": "Centro",
                "tipo_vivienda": 1,
                "m2": 80,
                "num_habitaciones": 3,
                "num_banos": 2,
                "planta": 2,
                "terraza": 1,
                "balcon": 0,
                "ascensor": 1,
                "estado": 2
            };
            console.log("JSON enviado:", data);
            // Enviar los datos a la API
            fetch('https://apiignite.onrender.com/api/prediccion/', {
                method: 'POST', // Cambiar a POST si tu API lo requiere
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
                
                .then(result => {
                    console.log('Respuesta de la API:', result); // Ver la respuesta como texto antes de intentar convertirla
                    alert('Predicción recibida. Revisa la consola para más detalles.');
                })

                .catch(error => {
                    console.error('Error completo:', error);
                    alert('Hubo un problema al procesar la solicitud. Verifica la consola para más detalles.');
                });

        });

    </script>


</body>
<style>
    .welcome-banner {
        width: calc(100vw - 20px);
        height: 105px;
        background-color: white;
        text-align: left;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 10;
        margin-left: 250px;
    }

    .welcome-title {
        margin: 0;
        font-size: 35px;
        font-weight: bold;
        color: blue;
        line-height: 100px;

    }

    .row.mb-3 .col {
        margin-bottom: 10px;
    }

    .form-label {
        white-space: nowrap;
        font-size: 14px;
    }

    .form-select {
        width: 100%;
    }

    h1,
    h4.text-center,
    h4.text {
        color: blue;
        text-decoration: underline;
        font-weight: bold;
    }

    body {
        background-color: #dcdcdc;
    }

    .tb {
        margin-left: 100px;
        background: #ffffff;
    }

    .tb1 {
        margin-left: 100px;
        background: #ffffff;
        width: 200px;
    }

    .vl {
        margin-left: 180px;
    }

    .content {
        padding: 20px;
    }

    .btn-primary {
        color: #ba31dd;
        font-weight: bold;
        background-color: #ffffff;
        border: none;
        margin-bottom: 30px;
    }
</style>

</html>
{% endblock %}